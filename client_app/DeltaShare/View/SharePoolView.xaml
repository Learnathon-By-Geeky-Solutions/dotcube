<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="DeltaShare.View.SharePoolView"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:model="clr-namespace:DeltaShare.Model"
    xmlns:viewmodel="clr-namespace:DeltaShare.ViewModel"
    xmlns:zxing="clr-namespace:ZXing.Net.Maui.Controls;assembly=ZXing.Net.MAUI.Controls"
    Title=""
    x:DataType="viewmodel:SharePoolViewModel"
    Shell.ForegroundColor="{StaticResource Grad1}">
    <Grid
        Padding="16,16"
        RowDefinitions="Auto,Auto,Auto,Auto,Auto,Auto,Auto"
        RowSpacing="4">
        <Grid Grid.Row="0" ColumnDefinitions="Auto,*">
            <Label
                Grid.Column="0"
                FontAttributes="Bold"
                FontSize="18"
                Text="Pool users"
                TextColor="{StaticResource Grad1}"
                VerticalOptions="Center" />
            <Border
                Grid.Column="1"
                Margin="10,0,0,0"
                HeightRequest="18"
                Stroke="Transparent"
                StrokeShape="RoundRectangle 10"
                VerticalOptions="Center">
                <Border.Background>
                    <LinearGradientBrush>
                        <GradientStop Offset="0" Color="{StaticResource Grad1}" />
                        <GradientStop Offset="1" Color="{StaticResource Grad2}" />
                    </LinearGradientBrush>
                </Border.Background>
            </Border>
        </Grid>
        <CollectionView
            Grid.Row="1"
            Margin="16,0,0,0"
            ItemsLayout="HorizontalList"
            ItemsSource="{Binding PoolUsers}"
            SelectionMode="None">
            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="model:User">
                    <VerticalStackLayout>
                        <Border
                            Margin="0,0,0,0"
                            Background="Transparent"
                            HeightRequest="60"
                            Stroke="{StaticResource Grad1}"
                            StrokeShape="RoundRectangle 20,20,20,20"
                            StrokeThickness="4"
                            WidthRequest="60">
                            <Image Aspect="AspectFit" Source="user.png" />
                        </Border>
                        <Label
                            Margin="4,0,4,0"
                            FontAttributes="Bold"
                            HorizontalOptions="Center"
                            HorizontalTextAlignment="Center"
                            Text="{Binding ViewableUsername}" />
                    </VerticalStackLayout>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
        <Label
            Grid.Row="2"
            FontAttributes="Bold"
            FontSize="20"
            HorizontalOptions="Center"
            Text="Scan below QR code" />
        <Grid Grid.Row="3" HeightRequest="400">
            <zxing:BarcodeGeneratorView
                Margin="3"
                ForegroundColor="{StaticResource Grad1}"
                Format="QrCode"
                Value="{Binding QrCodeData}" />
        </Grid>
        <Label
            Grid.Row="4"
            FontAttributes="Bold"
            FontSize="20"
            HorizontalOptions="Center"
            Text="Or, Share below pool code" />
        <Label
            Grid.Row="5"
            FontAttributes="Bold"
            FontSize="32"
            HorizontalOptions="Center"
            Text="{Binding QrCodeData}"
            TextColor="{StaticResource Grad1}" />
        <Button
            x:Name="viewSharedFilesBtn"
            Grid.Row="6"
            Margin="10,10,10,0"
            Command="{Binding ClickViewSharedFilesBtnCommand}"
            FontSize="24"
            HorizontalOptions="Fill"
            Text="View Shared Files">
            <Button.ImageSource>
                <FontImageSource
                    FontFamily="FASolid"
                    Glyph="&#xf15b;"
                    Color="White" />
            </Button.ImageSource>
        </Button>

    </Grid>
</ContentPage>